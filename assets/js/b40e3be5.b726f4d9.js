"use strict";(self.webpackChunkeasy_page_doc=self.webpackChunkeasy_page_doc||[]).push([[6397],{5148:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>g,contentTitle:()=>y,default:()=>j,frontMatter:()=>p,metadata:()=>m,toc:()=>x});var o=t(6070),s=t(6113),a=t(8981);t(758);const r=e=>new Promise(((n,t)=>{setTimeout((()=>{n(!0)}),e)})),i=new Array(100).fill({}).map(((e,n)=>({label:`\u9009\u9879${n}`,value:n,mark:`\u8fd9\u662f\u9009\u9879${n}\u7684\u63cf\u8ff0`}))),l=a.nodeUtil.createField("goods","\u5546\u54c1",{value:{choosed:1},required:!0,mode:"single",actions:[{effectedKeys:["goods"],initRun:!0,action:async e=>{let{value:n,initRun:t}=e;return(0,a.searchAction)({async searchByChoosed(e){const n=await(async e=>(await r(1e3),{label:`\u9009\u9879${e}`,value:e,mark:`\u8fd9\u662f\u9009\u9879${e}\u7684\u63cf\u8ff0`}))(e);return n?[n]:[]},async searchByKeyword(e){const n=await(async e=>(console.log("searchByKeywords:",e),await r(1e3),e?i.filter((n=>n.label.includes(e))):i))(e);return n||[]},initRun:t,value:n})}}]},{ui:a.UI_COMPONENTS.SELECT,select:{showSearch:!0,notFoundContent:null,filterOption:!1}});var c=t(3533);const d=new a.PageUtil({pageId:"form-page"});d.addFields([l,c.K]);const u=d.getPageInfo(),h=()=>(0,o.jsx)(a.EasyPage,{...u,components:a.DEFAULT_COMPONENTS,pageType:"form"}),p={sidebar_position:2},y="\u641c\u7d22\u4e0b\u62c9\u6846",m={id:"tutorial-basics/create-select",title:"\u641c\u7d22\u4e0b\u62c9\u6846",description:"\u5728\u8868\u5355\u4e2d\uff0c\u4e0b\u62c9\u6846\u7684\u5904\u7406\u4e5f\u662f\u4e00\u4e2a\u6bd4\u8f83\u590d\u6742\u7684\u573a\u666f\uff0c\u5b83\u590d\u6742\u5728\uff1a",source:"@site/docs/tutorial-basics/create-select.mdx",sourceDirName:"tutorial-basics",slug:"/tutorial-basics/create-select",permalink:"/easy-page-doc/docs/tutorial-basics/create-select",draft:!1,unlisted:!1,editUrl:"https://github.com/easy-page/easy-page-doc/docs/tutorial-basics/create-select.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"\u521b\u5efa\u57fa\u7840\u8868\u5355",permalink:"/easy-page-doc/docs/tutorial-basics/create-basic-form"},next:{title:"\u589e\u5220\u5b50\u8868\u5355",permalink:"/easy-page-doc/docs/tutorial-basics/create-child-form"}},g={},x=[{value:"\u6848\u4f8b",id:"\u6848\u4f8b",level:2},{value:"\u6539\u8fdb",id:"\u6539\u8fdb",level:2},{value:"Demo",id:"demo",level:2}];function f(e){const n={code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"\u641c\u7d22\u4e0b\u62c9\u6846",children:"\u641c\u7d22\u4e0b\u62c9\u6846"}),"\n",(0,o.jsx)(n.p,{children:"\u5728\u8868\u5355\u4e2d\uff0c\u4e0b\u62c9\u6846\u7684\u5904\u7406\u4e5f\u662f\u4e00\u4e2a\u6bd4\u8f83\u590d\u6742\u7684\u573a\u666f\uff0c\u5b83\u590d\u6742\u5728\uff1a"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"\u53ef\u4ee5\u57fa\u4e8e\u641c\u7d22\uff0c\u53bb\u83b7\u53d6\u4e0b\u62c9\u6846\u9009\u9879\u6570\u636e\u3002"}),"\n",(0,o.jsx)(n.li,{children:"\u5728\u7f16\u8f91\u7684\u65f6\uff0c\u9700\u8981\u8fdb\u884c\u56de\u586b\uff0c\u4e4b\u524d\u57fa\u4e8e\u5173\u952e\u8bcd\u641c\u7d22\u7684\u9009\u9879\uff0c\u5728\u56de\u586b\u65f6\uff0c\u67e5\u8be2\u9009\u9879\u6216\u8fd8\u9700\u518d\u67e5\u8be2\u4e00\u6b21\u3002"}),"\n",(0,o.jsx)(n.li,{children:"\u56de\u586b\u65f6\uff0c\u57fa\u4e8e\u56de\u586b\u7684\u9009\u9879\u91cc\u989d\u5916\u7684\u4fe1\u606f\uff0c\u505a\u76f8\u5173\u63d0\u793a\u4fe1\u606f\u5c55\u793a\u3002"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"\u6848\u4f8b",children:"\u6848\u4f8b"}),"\n",(0,o.jsx)(n.p,{children:"\u4e0a\u8ff0\u63cf\u8ff0\uff0c\u53ef\u80fd\u6709\u70b9\u4e91\u91cc\u96fe\u91cc\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e0b\u8ff0\u4f8b\u5b50\u6765\u611f\u53d7\u5176\u590d\u6742\uff1a"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\u521b\u5efa\u4e00\u4e2a\u4e0b\u62c9\u6846","\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",children:"import {\n  Empty,\n  SelectEffectType,\n  SelectState,\n  UI_COMPONENTS,\n  nodeUtil,\n} from '@easy-page/antd-ui';\n\nimport type { DefaultOptionType } from 'antd/es/select';\ntype GoodState = SelectState<number, { mark: string }>;\n\nexport const goods = nodeUtil.createField<\n  GoodState,\n  { goods: GoodState },\n  Empty,\n  SelectEffectType<{ mark: string }>\n>(\n  'goods',\n  '\u5546\u54c1',\n  {\n    /** \u9ed8\u8ba4\u9009\u4e2d\u4e00\u4e2a\u9009\u9879\u7684 id **/\n    value: { choosed: 1 },\n    required: true,\n    mode: 'single',\n  },\n  {\n    ui: UI_COMPONENTS.SELECT,\n    select: {\n      /** \u4e0b\u62c9\u6846 antd \u7684\u4e00\u4e9b\u914d\u7f6e\uff0c\u4fbf\u4e8e\u540e\u7eed\u505a\u641c\u7d22\u529f\u80fd **/\n      showSearch: true,\n      notFoundContent: null,\n      filterOption: false,\n    },\n  }\n);\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\u589e\u52a0 ",(0,o.jsx)(n.code,{children:"action"})," \u526f\u4f5c\u7528\u52a0\u8f7d\u6570\u636e\u3002","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"\u521d\u59cb\u5316\u65f6\uff0c\u52a0\u8f7d\u9ed8\u8ba4\u67e5\u8be2\u9009\u9879\uff1b\u5982\u679c\u67e5\u8be2\u9009\u9879\u4e2d\u4e0d\u5305\u542b\u9ed8\u8ba4\u9009\u4e2d\u7684\u9009\u9879\uff0c\u5219\u57fa\u4e8e ID \u67e5\u8be2\u8be5\u9009\u9879\uff1b\u5408\u5e76\u67e5\u8be2\u7ed3\u679c\u5e76\u8fd4\u56de\u3002"}),"\n",(0,o.jsx)(n.li,{children:"\u5728\u641c\u7d22\u65f6\uff0c\u57fa\u4e8e\u5173\u952e\u8bcd\uff0c\u67e5\u8be2\u9009\u9879\uff1b\u540c\u7406\u5982\u679c\u67e5\u8be2\u7684\u9009\u9879\u4e2d\u4e0d\u5305\u542b\u5df2\u9009\u62e9\u9009\u9879\uff0c\u5219\u7ee7\u7eed\u67e5\u8be2\u4e00\u6b21\u3002"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",children:"export const goods = nodeUtil.createField<\n  GoodState,\n  { goods: GoodState },\n  Empty,\n  SelectEffectType<{ mark: string }>\n>(\n  'goods',\n  '\u5546\u54c1',\n  {\n    ...\n    actions: [\n      {\n        /** \u76d1\u542c\u81ea\u8eab value \u7684\u53d8\u5316\uff0c\u611f\u77e5 keyword \u53d8\u5316\uff0c\u6267\u884c\u526f\u4f5c\u7528\u3002 **/\n        effectedKeys: ['goods'],\n        /** \u521d\u59cb\u5316\u6267\u884c */\n        initRun: true,\n        /** \u521d\u59cb\u5316\u67e5\u8be2\u9009\u4e2d\u6570\u636e */\n        action: async ({ value, initRun }) => {\n          /** \u53ea\u6709\u521d\u59cb\u5316\u65f6\uff0c\u6216\u8005\u5b58\u5728\u5173\u952e\u8bcd\u65f6\u624d\u505a\u67e5\u8be2 **/\n          if (initRun || value.keyword !== undefined) {\n            /** \u67e5\u8be2\u9009\u9879 */\n            const options = (await searchByKeywords(value.keyword)) || [];\n            const hasChoosed = options.find((x) => x.value === value.choosed);\n            if (value.choosed && !hasChoosed) {\n              /** \u9009\u62e9\u7684\u9009\u9879\u4e0d\u5728\u67e5\u8be2\u7684\u5217\u8868\u4e2d\uff0c\u5355\u72ec\u641c\u7d22\u9009\u4e2d\u9009\u9879 */\n              const choosed = await searchById(value.choosed);\n              return {\n                fieldValue: {\n                  ...value,\n                  options: [choosed, ...options],\n                  keyword: undefined,\n                },\n              };\n            }\n            return { fieldValue: { ...value, options, keyword: undefined } };\n          }\n          return {};\n        },\n      },\n    ],\n  },\n  ...\n);\n\n"})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"\u6539\u8fdb",children:"\u6539\u8fdb"}),"\n",(0,o.jsxs)(n.p,{children:["\u4ece\u4e0a\u9762\u793a\u4f8b\u7684\uff1a",(0,o.jsx)(n.code,{children:"action"})," \u4e2d\u53ef\u89c1\u5176\u590d\u6742\u7a0b\u5ea6\uff0c\u5f53\u7136\u8fd9\u6837\u7684\u903b\u8f91\uff0c\u6211\u4eec\u53ef\u4ee5\u62bd\u8c61\u5230\u5e95\u5c42\u57fa\u7840\u7ec4\u4ef6\u3002\u8fd9\u6837\u6211\u4eec\u7684 ",(0,o.jsx)(n.code,{children:"action"})," \u903b\u8f91\u5c31\u4f1a\u53d8\u6210\uff1a"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-tsx",children:"import { searchAction } from '@easy-page/antd-ui';\n\n  export const goods = nodeUtil.createField<\n    GoodState,\n    { goods: GoodState },\n    Empty,\n    SelectEffectType<{ mark: string }>\n  >(\n    'goods',\n    '\u5546\u54c1',\n    {\n      ...\n      actions: [\n        {\n          ...\n          action: async ({ value, initRun }) => {\n            return searchAction<number, { mark: string }>({\n              async searchByChoosed(choosed) {\n                const result = await searchById(choosed);\n                return result ? [result] : [];\n              },\n              async searchByKeyword(keyword) {\n                const result = await searchByKeywords(keyword);\n                return result || [];\n              },\n              initRun,\n              value,\n            });\n          },\n        },\n      ],\n    },\n    ...\n  );\n\n \n\n"})}),"\n",(0,o.jsx)(n.h2,{id:"demo",children:"Demo"}),"\n",(0,o.jsx)(n.p,{children:"\u6211\u4eec\u6765\u770b\u770b\u6b64\u65f6\u7684\u5b9e\u9645\u6548\u679c\uff1a"}),"\n","\n",(0,o.jsx)(h,{})]})}function j(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(f,{...e})}):f(e)}},3533:(e,n,t)=>{t.d(n,{K:()=>l});var o=t(8981),s=(t(758),t(6137)),a=t(6070);const r=o.nodeUtil.createCustomNode("validate",(e=>{let{frameworkProps:{getFormUtil:n}}=e;return(0,a.jsx)(s.Ay,{onClick:async()=>{const e=n?.();try{await(e?.validateAll())}catch(t){console.log("\u9a8c\u8bc1\u7ed3\u679c:",t)}},children:"\u9a8c\u8bc1"})}),{value:""}),i=o.nodeUtil.createCustomNode("submit",(e=>{let{frameworkProps:{getFormUtil:n}}=e;return(0,a.jsx)(s.Ay,{type:"primary",style:{marginLeft:12},onClick:()=>{const e=n?.();console.log("\u8868\u5355\u503c\uff1a",e?.getFormData())},children:"\u8868\u5355\u503c"})}),{value:""}),l=o.nodeUtil.createContainer("tool-bar",(e=>{let{children:n}=e;return(0,a.jsx)("div",{className:"flex flex-row",style:{marginBottom:12},children:n})})).appendChildren([r,i])}}]);